{"version":3,"sources":["webpack:///./tasks/../src/common/storage.js"],"names":["Storage","url","name","obj","get","data","resove","chrome","storage","sync","set","runtime","lastError","reject","result","decoErrFn","target","descriptor","fn","value","apply","arguments","catch","console","error","e","location","origin"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEMA,O;AACF,qBAAYC,GAAZ,EAAiB;AAAA;;AACb,aAAKA,GAAL,GAAWA,GAAX;AACH;;;;;iHAESC,I,EAAMC,G;;;;;;;;;uCACK,KAAKC,GAAL,E;;;AAAbC,oC;;AACJ,oCAAI,CAACA,IAAL,EAAW;AACPA,2CAAO,EAAP;AACH;iEACM,sBAAY,UAACC,MAAD,EAAY;AAC3BC,2CAAOC,OAAP,CAAeC,IAAf,CAAoBC,GAApB,mCACK,MAAKT,GADV,EACgB,sBAAcI,IAAd,oCACPH,IADO,EACAC,GADA,EADhB,GAIG,YAAM;AACL,4CAAII,OAAOI,OAAP,CAAeC,SAAnB,EAA8B;AAC1BC;AACH,yCAFD,MAEO;AACHP;AACH;AACJ,qCAVD;AAWH,iCAZM,C;;;;;;;;;;;;;;;;;;4BAePJ,I,EAAM;AAAA;;AACN,mBAAO,sBAAY,UAACI,MAAD,EAAY;AAC3BC,uBAAOC,OAAP,CAAeC,IAAf,CAAoBL,GAApB,CACI,CAAC,OAAKH,GAAN,CADJ,EAEE,gBAAQ;AACN,wBAAIa,SAAS,EAAb;AACA,wBAAIT,KAAK,OAAKJ,GAAV,CAAJ,EAAoB;AAChBa,iCAAST,KAAK,OAAKJ,GAAV,CAAT;AACH;AACDK,2BAAOJ,OAAOY,OAAOZ,IAAP,CAAP,GAAsBY,OAAO,OAAKb,GAAZ,CAA7B;AACH,iBARD;AASH,aAVM,CAAP;AAWH;;;0DAjCAc,S,4IAoBAA,S;;;AAgBL,SAASA,SAAT,CAAmBC,MAAnB,EAA2Bd,IAA3B,EAAiCe,UAAjC,EAA6C;AACzC,QAAIC,KAAKD,WAAWE,KAApB;AACAF,eAAWE,KAAX,GAAmB,YAAW;AAC1B,eAAOD,GAAGE,KAAH,CAAS,IAAT,EAAeC,SAAf,EAA0BC,KAA1B,CAAgC,aAAK;AACxCC,oBAAQC,KAAR,CAAc,0BAA0BC,CAAxC;AACH,SAFM,CAAP;AAGH,KAJD;AAKH;;kBAEc,IAAIzB,OAAJ,CAAY0B,SAASC,MAArB,C","file":"count.d3ab39c27fbb3c407d4b.hot-update.js","sourcesContent":["\n\nclass Storage {\n    constructor(url) {\n        this.url = url;\n    }\n    @decoErrFn\n    async set(name, obj) {\n        let data = await this.get();\n        if (!data) {\n            data = {};\n        }\n        return new Promise((resove) => {\n            chrome.storage.sync.set({\n                [this.url]: Object.assign(data, {\n                    [name]: obj\n                })\n            }, () => {\n                if (chrome.runtime.lastError) {\n                    reject()\n                } else {\n                    resove();\n                }\n            })\n        })\n    }\n    @decoErrFn\n    get(name) {\n        return new Promise((resove) => {\n            chrome.storage.sync.get(\n                [this.url]\n            , data => {\n                let result = {};\n                if (data[this.url]) {\n                    result = data[this.url];\n                }\n                resove(name ? result[name] : result[this.url]);\n            })\n        })\n    }\n}\n\nfunction decoErrFn(target, name, descriptor) {\n    let fn = descriptor.value;\n    descriptor.value = function() {\n        return fn.apply(this, arguments).catch(e => {\n            console.error('chrome storage error:' + e);\n        })\n    }\n}\n\nexport default new Storage(location.origin);"],"sourceRoot":""}